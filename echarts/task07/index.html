<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ECharts NO.7 - 空气质量可视化</title>
    <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>
    <script src="//cdn.bootcss.com/echarts/3.4.0/echarts.js"></script>
</head>
<body>
    <div id="main" style="width: 800px; height: 600px;"></div>
    <script>
    /* 将数组转换为符合格式的数组
     * "湛江": [
     *   {
     *     "time": "2000-06-05 00:00:00",
     *     "value": 57
     *   },
     *   {
     *     "time": "2000-06-09 00:00:00",
     *     "value": 62
     *   }]
     */
    function convertData (ary) {
        // 将时间作为分类
        const categoryData = []
        // 空气质量作为值
        const values = []
        for (let i = 0; i < ary.length; i++) {
            categoryData.push(ary[i].time)
            values.push(ary[i].value)
        }
        return {
            categoryData,
            values
        }
    }
    const myChart = echarts.init(document.getElementById('main'))
    myChart.showLoading()
    $.get('./aqi/data.json', (res) => {
        myChart.hideLoading()

        const data = convertData(res['湛江'])
        // console.log(data)
        option = {
            title: {
                text: '空气质量'
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                // data:['邮件营销','联盟广告','视频广告','直接访问','搜索引擎']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            xAxis: {
                type: 'category',
                // x 轴显示时间
                data: data.categoryData,
                scale: true,
                boundaryGap : false,
                axisLine: {
                    onZero: false
                },
                splitLine: {
                    show: false
                },
                splitNumber: 20,
                min: 'dataMin',
                max: 'dataMax'
            },
            yAxis: {
                scale: true,
                splitArea: {
                    show: true
                }
            },
            // 缩放
            dataZoom: [
                {
                    type: 'inside',
                    start: 50,
                    end: 100
                },
                {
                    show: true,
                    type: 'slider',
                    y: '90%',
                    start: 50,
                    end: 100
                }
            ],
            series: [
                {
                    name:'湛江',
                    type:'line',
                    data: data.values
                }
            ]
        }
        myChart.setOption(option)
    })
    </script>
    
</body>
</html>