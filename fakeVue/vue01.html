<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>动态数据绑定（一）</title>
</head>
<body>
    <script>
        /*
         * 构造函数
         * @param (Object)required data
         */
        function Observer(data) {
            var _data = {}
            // 通过遍历 data 实现将 data 上的每一个值都拷贝到 this.data 上
            for(var key in data) {
                (function(key) {
                    // 给 this.data 添加属性
                    Object.defineProperty(_data, key, {
                        get: function() {
                            console.log('读取了', key)
                            return data[key]
                        },
                        set: function(newValue) {
                            console.log(key,'被修改为', newValue)
                            // _data[key] = newValue
                            data[key] = newValue
                        }
                    })
                })(key)
            }
            this.data = _data
            return this
        }
        document.body.onload = function () {
            app1 = new Observer({
                name: 'youngwind',
                age: 25
            })

            var app2 = new Observer({
                university: 'bupt',
                major: 'computer'
            })

            // 访问值时要求打印信息
            app1.data.name
            // 修改值时要求打印信息
            app1.data.age = 26
            app2.data.university
            app2.data.major = 'science'
        }
    </script>
</body>
</html>
